<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Image Quantization Library (image-q)</title>
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
	<script src="assets/js/modernizr.js"></script>
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.js" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">Image Quantization Library (image-q)</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
							<input type="checkbox" id="tsd-filter-only-exported" />
							<label class="tsd-widget" for="tsd-filter-only-exported">Only exported</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
				<li>
					<a href="globals.html">Globals</a>
				</li>
			</ul>
			<h1> Image Quantization Library (image-q)</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<h2 id="iq-ts">IQ.ts</h2>
				<p>Image Quantization Library in <strong>TypeScript</strong> <em>(MIT License)</em>
				<img src="https://raw.githubusercontent.com/leeoniya/RgbQuant.js/master/quantization.png" alt="quantization" title="quantization"></p>
				<h2 id="introduction">Introduction</h2>
				<p>Image Color Number Reduction with alpha support using RgbQuant/NeuQuant/Xiaolin Wu&#39;s algorithms and Euclidean/Manhattan/CIEDE2000 color distance formulas in TypeScript</p>
				<p><a href="http://igor-bezkrovny.github.io/image-q/doc">API</a><br><a href="http://igor-bezkrovny.github.io/image-q/demo">Online Demo</a><br><a href="https://github.com/igor-bezkrovny/igor-bezkrovny.github.io/image-quantization-demo">Demo Source</a></p>
				<h2 id="capability">Capability</h2>
				<table>
					<thead>
						<tr>
							<th>title</th>
							<th>description</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td>Import</td>
							<td><strong>HTMLImageElement, HTMLCanvasElement, NodeCanvas, ImageData, Array, CanvasPixelArray, Uint8Array, Uint32Array</strong>  </td>
						</tr>
						<tr>
							<td>Palette</td>
							<td><strong>NeuQuant, RgbQuant, Xiaolin Wu&#39;s method</strong>  </td>
						</tr>
						<tr>
							<td>Image</td>
							<td><strong>Nearest Color, Error Diffusion Dithering</strong>  </td>
						</tr>
						<tr>
							<td>Export</td>
							<td><strong>Uint32Array, Uint8Array</strong>  </td>
						</tr>
					</tbody>
				</table>
				<h2 id="include-iq-library-into-your-project">Include IQ Library into your project</h2>
				<h5 id="typescript-node-js-browser-project">TypeScript + Node.js/Browser project</h5>
				<pre><code class="lang-javascript"><span class="hljs-comment">/// &lt;reference path='&lt;path-to-iq&gt;/src/iq.ts' /&gt;</span>
</code></pre>
				<h5 id="javascript-node-js-project">JavaScript + Node.js project</h5>
				<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> iq = <span class="hljs-built_in">require</span>(<span class="hljs-string">"&lt;path-to-iq&gt;/dist/node-iq.js"</span>);
</code></pre>
				<h5 id="javascript-browser-project">JavaScript + Browser project</h5>
				<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"&lt;path-to-iq&gt;/dist/browser-iq.js"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/javascript"</span> <span class="hljs-attribute">charset</span>=<span class="hljs-value">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
</code></pre>
				<h2 id="usage-example">Usage Example</h2>
				<h5 id="load-image-simple-example-">Load Image (simple example)</h5>
				<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> img = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"img"</span>);
img.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// image is loaded, here should be all code utilizing image</span>
    ...
}
img.src = <span class="hljs-string">"http://pixabay.com/static/uploads/photo/2012/04/11/11/32/letter-a-27580_640.png"</span>
</code></pre>
				<h5 id="generate-palette">Generate Palette</h5>
				<pre><code class="lang-javascript"><span class="hljs-comment">// desired colors number</span>
<span class="hljs-keyword">var</span> targetColors = <span class="hljs-number">256</span>;

<span class="hljs-comment">// create pointContainer and fill it with image</span>
<span class="hljs-keyword">var</span> pointContainer = IQ.Utils.PointContainer.fromHTMLImageElement(img);

<span class="hljs-comment">// create chosen distance calculator (see classes implementing `IQ.Distance.IDistanceCalculator`)</span>
<span class="hljs-keyword">var</span> distanceCalculator = <span class="hljs-keyword">new</span> IQ.Distance.Euclidean();

<span class="hljs-comment">// create chosen palette quantizer (see classes implementing `IQ.Palette.IPaletteQuantizer`) </span>
<span class="hljs-keyword">var</span> paletteQuantizer = <span class="hljs-keyword">new</span> IQ.Palette.RgbQuant(distanceCalculator, targetColors);

<span class="hljs-comment">// feed out pointContainer filled with image to paletteQuantizer</span>
paletteQuantizer.sample(pointContainer);

... (you may sample more than one image to create mutual palette) 

<span class="hljs-comment">// take generated palette</span>
<span class="hljs-keyword">var</span> palette = paletteQuantizer.quantize();
</code></pre>
				<h5 id="apply-palette-to-image-image-dithering-">Apply Palette to Image (Image Dithering)</h5>
				<pre><code class="lang-javascript"><span class="hljs-comment">// create image quantizer (see classes implementing `IQ.Image.IImageDitherer`)</span>
<span class="hljs-keyword">var</span> imageDitherer = <span class="hljs-keyword">new</span> IQ.Image.NearestColor(distanceCalculator);

<span class="hljs-comment">// apply palette to image</span>
<span class="hljs-keyword">var</span> resultPointContainer = imageQuantizer.quantize(pointContainer, palette);
</code></pre>
				<p>You may work with resultPointContainer directly or you may convert it to <code>Uint8Array</code>/<code>Uint32Array</code></p>
				<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> uint8array = resultPointContainer.toUint8Array();
</code></pre>
				<h2 id="todo">TODO</h2>
				<pre><code><span class="hljs-bullet">1. </span>notification about progress
~~2. riemersma dithering~~
<span class="hljs-bullet">3. </span>ordered dithering
</code></pre><h2 id="changelog">Changelog</h2>
				<h5 id="0-1-4-2015-06-24-">0.1.4 (2015-06-24)</h5>
				<pre><code><span class="hljs-bullet">+ </span>Refactoring
<span class="hljs-bullet">+ </span>Riemersma dithering added (Hilbert Curve)
<span class="hljs-bullet">+ </span>Readme.md updated
<span class="hljs-bullet">+ </span>build.cmd updated
</code></pre><h5 id="0-1-3-2015-06-16-">0.1.3 (2015-06-16)</h5>
				<pre><code>+ NeuQuant <span class="hljs-keyword">is</span> fixed (again) according <span class="hljs-keyword">to</span> original Anthony Dekker source code (all values should be <span class="hljs-built_in">integer</span>)
+ <span class="hljs-keyword">Error</span> Diffusion Dithering <span class="hljs-keyword">is</span> now calculates <span class="hljs-keyword">error</span> <span class="hljs-keyword">like</span> XNVIEW
+ Refactoring
</code></pre><h5 id="0-1-2-2015-06-16-">0.1.2 (2015-06-16)</h5>
				<pre><code>+ Documentation generation <span class="hljs-keyword">fixed</span>
+ File name <span class="hljs-keyword">case</span> problem <span class="hljs-keyword">fixed</span>
</code></pre><h5 id="0-1-1-2015-06-16-">0.1.1 (2015-06-16)</h5>
				<pre><code><span class="hljs-bullet">+ </span>Auto-generated documentation added
<span class="hljs-bullet">+ </span>Refactoring 
</code></pre><h5 id="0-1-0-2015-06-16-">0.1.0 (2015-06-16)</h5>
				<pre><code>+ <span class="hljs-preprocessor">Code</span> cleanup, removed unnecessary files
</code></pre><h5 id="0-0-5-2015-06-16-">0.0.5 (2015-06-16)</h5>
				<pre><code>+ PNGQUANT color distance added, need to <span class="hljs-operator"><span class="hljs-keyword">check</span> its quality
+ CIEDE2000 <span class="hljs-keyword">and</span> CIE94 fixed <span class="hljs-keyword">for</span> <span class="hljs-keyword">use</span> <span class="hljs-keyword">in</span> NeuQuant
+ NeuQuant <span class="hljs-keyword">is</span> fixed according <span class="hljs-keyword">to</span> original Anthony Dekker source code (<span class="hljs-keyword">all</span> <span class="hljs-keyword">values</span> should be <span class="hljs-built_in">integer</span>) 
+ Code refactoring <span class="hljs-keyword">and</span> cleanup
* We have <span class="hljs-keyword">some</span> slowdown because <span class="hljs-keyword">of</span> red/green/blue/alpha normalization according <span class="hljs-keyword">to</span> white point per <span class="hljs-keyword">each</span> calculateRaw/calculateNormalized <span class="hljs-keyword">call</span> </span>
</code></pre><h5 id="0-0-4-2015-06-15-">0.0.4 (2015-06-15)</h5>
				<pre><code>+ CIEDE2000 color distance equation optimized (original CIEDE2000 equation <span class="hljs-keyword">is</span> available <span class="hljs-keyword">as</span> <span class="hljs-class"><span class="hljs-keyword">class</span> `<span class="hljs-title">CIEDE2000_Original</span>`) </span>
</code></pre><h5 id="0-0-3b-2015-06-11-">0.0.3b (2015-06-11)</h5>
				<pre><code>+ CMETRIC <span class="hljs-keyword">color</span> <span class="hljs-built_in">distance</span> fixed
</code></pre><h5 id="0-0-3a-2015-06-11-">0.0.3a (2015-06-11)</h5>
				<pre><code><span class="hljs-bullet">+ </span>Cleanup
<span class="hljs-bullet">+ </span>Draft of CMETRIC color distance added
</code></pre><h5 id="0-0-2-2015-06-10-">0.0.2 (2015-06-10)</h5>
				<pre><code>+ rgb2xyz &amp; xyz2lab fixed. CIEDE2000 works much <span class="hljs-keyword">better </span>now.
+ CIE94 distance formula <span class="hljs-keyword">added. </span>More investigation is needed.
</code></pre><h5 id="0-0-1">0.0.1</h5>
				<pre><code><span class="hljs-bullet">+ </span>Initial
</code></pre><h2 id="license">License</h2>
				<p>License MIT <a href="./src/paletteQuantizers/neuquant/neuquant.ts">(NeuQuant use also forces to add it&#39;s copyright notice into source code)</a></p>
				<h2 id="credits">Credits</h2>
				<p>Thanks to Leon Sorokin for information share and his original RgbQuant!</p>
				<h2 id="references">References</h2>
				<ul>
					<li><p>Palette Quantization Algorithms</p>
						<ol>
							<li><a href="https://github.com/leeoniya/RgbQuant.js">RgbQuant (Leon Sorokin)</a> <code>JavaScript</code></li>
							<li><a href="https://github.com/jnordberg/gif.js/blob/master/src/TypedNeuQuant.js">NeuQuant (Johan Nordberg)</a> <code>TypeScript</code></li>
							<li><a href="https://github.com/timoxley/neuquant">NeuQuant (Tim Oxley)</a> <code>JavaScript</code></li>
							<li><a href="https://github.com/devongovett/neuquant">NeuQuant (Devon Govett)</a> <code>JavaScript</code></li>
							<li><a href="https://github.com/stuart/pngnq/blob/master/src/neuquant32.c">NeuQuant32 (Stuart Coyle)</a> <code>C</code></li>
							<li><a href="http://www.ece.mcmaster.ca/~xwu/cq.c">Xiaolin Wu (Xiaolin Wu)</a> <code>C</code> </li>
							<li><a href="http://www.codeproject.com/Articles/66341/A-Simple-Yet-Quite-Powerful-Palette-Quantizer-in-C">Xiaolin Wu (Smart-K8)</a> <code>C#</code></li>
							<li>Xiaolin Wu w/ Alpha (Matt Wrock) <a href="https://code.msdn.microsoft.com/windowsdesktop/Convert-32-bit-PNGs-to-81ef8c81/view/SourceCode#content">How to add Alpha</a>, <a href="https://nquant.codeplex.com">Source Code</a> <code>C#</code></li>
							<li><a href="https://github.com/mwcz/median-cut-js">MedianCut (mwcz)</a> <code>GPLv3</code></li>
						</ol>
					</li>
					<li><p>Image Quantization Algorithms</p>
						<ol>
							<li><a href="http://www.imagemagick.org/Usage/quantize/#dither">All (ImageMagik doc)</a></li>
							<li><a href="http://www.tannerhelland.com/4660/dithering-eleven-algorithms-source-code">Error Diffusion dithering (Tanner Helland)</a></li>
							<li><a href="http://www.compuphase.com/riemer.htm">Riemersma dithering</a> <code>TODO: Check License</code></li>
							<li><a href="http://bisqwit.iki.fi/story/howto/dither/jy">Ordered dithering (Joel Yliluoma)</a></li>
						</ol>
					</li>
					<li><p>Color Distance Formulas</p>
						<ol>
							<li>Euclidean Distance</li>
							<li>Manhattan Distance</li>
							<li>CIE94 Distance<ul>
									<li><a href="https://github.com/iuliux/CIE94.js">Source Code (Iulius Curt)</a></li>
								</ul>
							</li>
							<li>CIEDE2000<ul>
									<li><a href="http://www.ece.rochester.edu/~gsharma/ciede2000/ciede2000noteCRNA.pdf">Math and Test Data Table (PDF)</a> </li>
									<li><a href="https://github.com/gfiumara/CIEDE2000">Source Code (Greg Fiumara)</a> <code>C</code> </li>
								</ul>
							</li>
							<li>Euclidean Distance w/o Alpha (RgbQuant)</li>
							<li>Euclidean Distance w/o sRGB coefficients (Xiaolin Wu Quant)  </li>
							<li>Manhattan Distance w/o sRGB coefficients (NeuQuant)</li>
							<li><a href="http://www.compuphase.com/cmetric.htm">CMETRIC</a> <code>DRAFT!</code></li>
						</ol>
					</li>
					<li><p>Color conversion formulas</p>
						<ol>
							<li><a href="http://www.easyrgb.com/?X=MATH">Pseudo-code</a></li>
						</ol>
					</li>
				</ul>
				<blockquote>
					<p>Be sure to fix rgb2xyz/xyz2lab. Issue is with strange part of code: <code>r = r &gt; 0.04045 ? ...</code>. Check <a href="http://en.wikipedia.org/wiki/Lab_color_space">http://en.wikipedia.org/wiki/Lab_color_space</a>   </p>
				</blockquote>
				<ul>
					<li><p>Image Quality Assessment</p>
						<ol>
							<li><a href="http://en.wikipedia.org/wiki/Structural_similarity">SSIM info</a></li>
							<li><a href="https://github.com/rhys-e/structural-similarity">SSIM (Rhys-e)</a> <code>Java</code> <code>License: MIT</code></li>
							<li>PSNR ? TBD</li>
							<li>MSE ? TBD</li>
						</ol>
					</li>
					<li><p>Other</p>
						<ol>
							<li><a href="http://www.husl-colors.org">HUSL (Boronine) - info</a></li>
							<li><a href="https://github.com/husl-colors/husl">HUSL (Boronine) - code</a></li>
						</ol>
					</li>
				</ul>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class="globals  ">
						<a href="globals.html"><em>Globals</em></a>
					</li>
					<li class="label tsd-is-external">
						<span>Externals</span>
					</li>
					<li class=" tsd-kind-module tsd-is-external">
						<a href="modules/iq.html">IQ</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-module"><span class="tsd-kind-icon">Module</span></li>
				<li class="tsd-kind-object-literal"><span class="tsd-kind-icon">Object literal</span></li>
				<li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li>
				<li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li>
				<li class="tsd-kind-function tsd-has-type-parameter"><span class="tsd-kind-icon">Function with type parameter</span></li>
				<li class="tsd-kind-index-signature"><span class="tsd-kind-icon">Index signature</span></li>
				<li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-enum"><span class="tsd-kind-icon">Enumeration</span></li>
				<li class="tsd-kind-enum-member"><span class="tsd-kind-icon">Enumeration member</span></li>
				<li class="tsd-kind-property tsd-parent-kind-enum"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-enum"><span class="tsd-kind-icon">Method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li>
				<li class="tsd-kind-interface tsd-has-type-parameter"><span class="tsd-kind-icon">Interface with type parameter</span></li>
				<li class="tsd-kind-constructor tsd-parent-kind-interface"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-interface"><span class="tsd-kind-icon">Method</span></li>
				<li class="tsd-kind-index-signature tsd-parent-kind-interface"><span class="tsd-kind-icon">Index signature</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
				<li class="tsd-kind-class tsd-has-type-parameter"><span class="tsd-kind-icon">Class with type parameter</span></li>
				<li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class"><span class="tsd-kind-icon">Accessor</span></li>
				<li class="tsd-kind-index-signature tsd-parent-kind-class"><span class="tsd-kind-icon">Index signature</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-constructor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static property</span></li>
				<li class="tsd-kind-call-signature tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static method</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="http://typedoc.io" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
<script>if (location.protocol == 'file:') document.write('<script src="assets/js/search.js"><' + '/script>');</script>
</body>
</html>